# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class Kommit < Formula
  desc "Therapeutic approach to git commits with AI-generated messages"
  homepage "https://github.com/cowboy-bebug/kommit"
  version "0.3.1"
  license "MIT"

  depends_on "git"
  depends_on "go" => "^1.24"

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/cowboy-bebug/kommit/releases/download/v0.3.1/kommit_v0.3.1_darwin_amd64.tar.gz"
      sha256 "24193b8fe085ca619b7e40544f43d3ed6c76e6124adef5db22ff5aee9190427c"

      def install
        bin.install "git-kommit"
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/cowboy-bebug/kommit/releases/download/v0.3.1/kommit_v0.3.1_darwin_arm64.tar.gz"
      sha256 "902220913733495a5c2bc7dcbf914b428a1d608ea4f579097b1b1a25276877ea"

      def install
        bin.install "git-kommit"
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel?
      if Hardware::CPU.is_64_bit?
        url "https://github.com/cowboy-bebug/kommit/releases/download/v0.3.1/kommit_v0.3.1_linux_amd64.tar.gz"
        sha256 "5fc411b1cec0df3949d3fd2597284b6d07fc1ac525716d75076032d9398c59e6"

        def install
          bin.install "git-kommit"
        end
      end
    end
    if Hardware::CPU.arm?
      if Hardware::CPU.is_64_bit?
        url "https://github.com/cowboy-bebug/kommit/releases/download/v0.3.1/kommit_v0.3.1_linux_arm64.tar.gz"
        sha256 "27859eca0418c9d713e9a62c9e700012f8f8dc6da15791ab9dde1ee51447aabd"

        def install
          bin.install "git-kommit"
        end
      end
    end
  end

  def caveats
    <<~EOS
      🧐 Your therapist is ready for session!

      To begin your repository's healing journey:
        git kommit init

      Remember to set your OpenAI API key:
        export OPENAI_API_KEY="sk-..."

      Or use a dedicated key for Kommit:
        export KOMMIT_OPENAI_API_KEY="sk-..."
    EOS
  end

  test do
    system "#{bin}/git", "kommit", "version"
  end
end
